{% extends 'base.html' %}
{% load static %}
{% block content %}
<div class="container py-5 mt-5" style="margin-top: 100px !important;">
  <div class="row justify-content-center">
    <div class="col-md-10 col-lg-8 col-xl-7">
      <div class="card shadow-lg border-0 p-0" style="border-radius: 18px; overflow: hidden; min-height: 650px;">
        <div class="card-body p-0">
          <div class="row g-0 align-items-center">
            <div class="col-12 text-center pt-4 pb-2" style="background: #f5f5f5;">
              {% if form.instance.photo %}
                <img src="{{ form.instance.photo.url }}" class="rounded-circle shadow mb-2" style="width: 110px; height: 110px; object-fit: cover; border: 3px solid #fff; box-shadow: 0 2px 8px #bbb;" alt="Profile Photo">
              {% else %}
                <img src="https://ui-avatars.com/api/?name={{ profile_user.first_name }}+{{ profile_user.last_name }}&size=110" class="rounded-circle shadow mb-2" style="width: 110px; height: 110px; object-fit: cover; border: 3px solid #fff; box-shadow: 0 2px 8px #bbb;" alt="Profile Photo">
              {% endif %}
              <div class="mt-2">
                {{ form.photo.label_tag }}<br>{{ form.photo }}
              </div>
            </div>
            <div class="col-12 px-4 py-4">
              <h4 class="mb-3 text-center text-primary" style="letter-spacing: 1px;">Student ID Card</h4>
              <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <h5 class="text-center fw-bold mb-3">Edit Student Details</h5>
                <div class="row">
                  <div class="form-group col-12 col-sm-6 mb-3">
                    <label class="form-label fw-semibold small">First Name</label>
                    <input type="text" name="first_name" class="form-control" value="{{ profile_user.first_name }}">
                  </div>
                  <div class="form-group col-12 col-sm-6 mb-3">
                    <label class="form-label fw-semibold small">Last Name</label>
                    <input type="text" name="last_name" class="form-control" value="{{ profile_user.last_name }}">
                  </div>
                  <div class="form-group col-12 col-sm-6 mb-3">
                    <label class="form-label fw-semibold small">Username</label>
                    <input type="text" name="username" class="form-control" value="{{ profile_user.username }}" readonly>
                  </div>
                  <div class="form-group col-12 col-sm-6 mb-3">
                    <label class="form-label fw-semibold small">Email</label>
                    <input type="email" name="email" class="form-control" value="{{ profile_user.email }}">
                  </div>
                </div>
                {{ form.non_field_errors }}
                {% csrf_token %}
                {{ form.non_field_errors }}
                <div class="row">
                  {% for field in form.visible_fields %}
                    {% if field.name != 'photo' %}
                    <div class="form-group col-12 col-sm-6 mb-3">
  <label class="form-label fw-semibold small">{{ field.label }}</label>
  {{ field }}
  {% if field.help_text %}<small class="form-text text-muted">{{ field.help_text }}</small>{% endif %}
  {% for error in field.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
</div>
                    {% endif %}
                  {% endfor %}
                </div>
                <button type="submit" class="btn btn-primary w-100 mt-2">Save Changes</button>
                <a href="{% url 'user_detail' user_id=profile_user.id %}" class="btn btn-secondary w-100 mt-2">Cancel</a>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
